{"version":3,"sources":["meteor://ðŸ’»app/subsites/bomb/itemselector/itemselector.js","meteor://ðŸ’»app/subsites/bomb/bomb.js","meteor://ðŸ’»app/subsites/project/server/bindings.js","meteor://ðŸ’»app/server/ordersync.js","meteor://ðŸ’»app/blueboard.js","meteor://ðŸ’»app/global.js","meteor://ðŸ’»app/routes.js"],"names":["Meteor","isClient","Template","ItemSelector","helpers","categories","cats","BOMBCategories","find","fetch","forEach","cat","items","BOMBItems","group_id","id","cat_is_empty","console","log","count","onRendered","$","accordion","events","boxes","first","checkbox","Mongo","Collection","subscribe","bomb","onCreated","call","e","form_values","serializeArray","base_id","apply_ids","cookies","input","name","value","push","Session","set","Date","getTime","length","base","apply","err","res","server_res","get","running","run_time_remaining","seconds","Math","ceil","max","color","msg","isServer","publish","methods","refreshItems","exactapi","isAuthorized","groups","getItemGroups","remove","batchInsert","group","getItems","description","item","insert","ID","Description","ItemGroup","code","Code","copyBOM","ids","key","hasOwnProperty","destItems","findOne","getBOM","sourceID","getShopOrder","nr","getItem","item_id","getSalesOrder","orderID","getShopOrderChildren","getShopOrders","options","getProject","getExactURL","getAuthURL","exactIsLinked","getDivision","getDivisions","setDivision","parseInt","updateOrders","updateCategories","Categories","Orders","update","category","$set","hoursTotal","hours","multi","dateFormat","date","getFullYear","month","getMonth","day","getDate","setInterval","setTimeout","MAXDIFF","orders","max_status","min_date","now","toJSON","newOrders","order","databaseElem","number","ShopOrderNumber","plannedDate","parseJSONDate","PlannedDate","status","Status","entryDate","EntryDate","blacklist","Blacklist","type","salesOrderLine","SalesOrderLines","results","customer","OrderID","DeliverToName","salesOrderLines","getSalesOrderLines","line","LineNumber","deliveryDate","DeliveryDate","netPrice","NetPrice","discount","parseFloat","Discount","toFixed","old_elem","tasks","Item","ItemGroupDescription","tokenRefresh","Employees","Events","addEvent","employee","start","allday","fullCalendar","val","moment","end","clone","format","newEvent","formSide","parent","hasClass","fullOrder","error","calendar","onEventsChanged","observeChanges","added","changed","removed","window","setAddEventState","ordersVisible","specialTypeSelected","every","updateNewEventDraggable","onEventChange","event","savedEvent","_id","title","diff","upsert","affected","navbar","exact_url","exact_linked","addBlacklist","resourcesbar","addEventButtonState","shape","onChange","theme","weekends","businessHours","defaultView","header","center","editable","tz","callback","theEvents","$gte","eventResize","eventDrop","eventRender","element","content","prepend","html","getEventTitle","click","showEventProperties","append","addClass","css","getOrderColor","hasEmployeeOverlap","dayClick","toDate","eventClick","droppable","drop","add","cursor","$or","$lte","$exists","Accounts","ui","config","passwordSignupFields","startup","daydiff","second","round","Router","route","template","render","data","params"],"mappings":"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","file":"/app.js","sourcesContent":["if(Meteor.isClient){\n    Template.ItemSelector.helpers({\n        categories: function(){\n            var cats = BOMBCategories.find({}).fetch();\n            cats.forEach(function(cat){\n                cat.items = BOMBItems.find({\n                   group_id: cat.id\n                }).fetch();\n            });\n            return cats;\n        },\n        cat_is_empty: function(id){\n            console.log(\"id: \"+id);\n            var count = BOMBItems.find({\n                group_id: id\n            }).count();\n            console.log(\"number of items: \"+count);\n            return count == 0;\n        }\n    });\n\n    Template.ItemSelector.onRendered(function(){\n       $('.accordion').accordion({});\n    });\n\n    Template.ItemSelector.events({\n        'click .button': function(){\n            var id = this.id;\n            var boxes = $(':not(.radio).checkbox[data-category='+id+']');\n            if(boxes.first().checkbox('is checked')){\n                boxes.checkbox('uncheck');\n            }\n            else {\n                boxes.checkbox('check');\n            }\n        }\n    });\n}\n","BOMBCategories = new Mongo.Collection(\"bomb_categories\");\nBOMBItems = new Mongo.Collection(\"bomb_items\");\n\nif(Meteor.isClient){\n    Meteor.subscribe(\"bomb_categories\");\n    Meteor.subscribe(\"bomb_items\");\n\n    Template.bomb.onCreated(function(){\n        Meteor.call(\"refreshItems\");\n    });\n\n    Template.bomb.events({\n        'click .negative.button': function(e){\n            console.log(\"Click!\");\n            var form_values = $('.bomb.form').serializeArray();\n            var base_id = \"\";\n            var apply_ids = [];\n            var cookies = {};\n            form_values.forEach(function(input){\n                if(input.name == \"base\"){\n                    base_id = input.value;\n                }\n                else if (input.name == \"apply\"){\n                    apply_ids.push(input.value);\n                }\n                else {\n                    cookies[input.name] = input.value;\n                }\n            });\n            Session.set(\"isRunning\", true);\n            Session.set(\"runFinishTime\", (new Date()).getTime() + (apply_ids.length*2000));\n            Meteor.call(\"copyBOM\", {\n                base: base_id,\n                apply: apply_ids,\n                cookies: cookies\n            }, function(err, res){\n                Session.set(\"bombServerResponse\", res);\n                Session.set(\"isRunning\", false);\n            });\n        },\n    });\n\n    Template.bomb.helpers({\n        cookies: function(){\n            return ['ExactOnlineLogin', 'ASP.NET_SessionId', 'PERSIST-EXACT', 'CSRFToken'];\n        },\n        server_res: function(){\n            return Session.get(\"bombServerResponse\");\n        },\n        running: function(){\n            return Session.get(\"isRunning\");\n        },\n        run_time_remaining: function(){\n            var seconds = Math.ceil((Session.get('runFinishTime')-new Date())/1000);\n            return Math.max(0, seconds);\n        },\n        color: function(msg){\n            if(msg == \"failed\"){\n                return \"red\"\n            } else {\n                return \"blue\"\n            }\n        }\n    });\n}\nelse if(Meteor.isServer){\n    Meteor.publish(\"bomb_categories\", function(){\n        return BOMBCategories.find({});\n    })\n    Meteor.publish(\"bomb_items\", function(){\n        return BOMBItems.find({});\n    })\n    Meteor.methods({\n        refreshItems: function(){\n           console.log(\"Refreshing Items\");\n           if(!exactapi.isAuthorized()){\n               console.log(\"Exact is not linked\");\n               return;\n           }\n\n           var groups = exactapi.getItemGroups();\n           console.log(\"Found \"+groups.length+\" groups!\");\n           BOMBCategories.remove({});\n           BOMBCategories.batchInsert(groups);\n\n           BOMBItems.remove({});\n           groups.forEach(function(group){\n                var items = exactapi.getItems(group.id);\n               console.log(\"Found \"+items.length+\" items for group \"+group.description);\n                items.forEach(function(item){\n                   BOMBItems.insert({\n                       id: item.ID,\n                       description: item.Description,\n                       group_id: item.ItemGroup,\n                       code: item.Code\n                   });\n                });\n           });\n        },\n        copyBOM: function(ids){\n            console.log(\"Will apply BOM of \"+ids.base+\" to \"+ids.apply);\n            for(var key in ids.cookies){\n                if(ids.cookies.hasOwnProperty(key)){\n                    console.log(key+\": \"+ids.cookies[key]);\n                }\n            }\n            var destItems = [];\n            ids.apply.forEach(function(id){\n               destItems.push(BOMBItems.findOne({ id: id }));\n            });\n            console.log(\"Copying BOM\");\n            var res = exactapi.copyBOM(ids.base, destItems, ids.cookies);\n            console.log(res);\n            return res;\n\n        }\n    });\n}","/**\n * Created by daan on 05/07/16.\n */\n\nMeteor.methods({\n    getBOM: function(sourceID){\n       return exactapi.getBOM(sourceID);\n    },\n    getShopOrder: function(nr){\n        return exactapi.getShopOrder(nr);\n    },\n    getItem: function (item_id) {\n        return exactapi.getItem(item_id);\n    },\n    getSalesOrder: function(orderID){\n        return exactapi.getSalesOrder(orderID);\n    },\n    getShopOrderChildren: function (orderID) {\n        return exactapi.getShopOrderChildren(orderID);\n    },\n    getShopOrders: function(options) {\n        return exactapi.getShopOrders(options);\n    },\n    getProject: function(options) {\n        return exactapi.getProject(options);\n    }\n});","/**\n * Created by daan on 31-10-15.\n */\n\nMeteor.methods({\n    getExactURL: function(){\n        return exactapi.getAuthURL();\n    },\n    exactIsLinked: function(){\n        return exactapi.isAuthorized();\n    },\n    getDivision: function(){\n        return exactapi.getDivision();\n    },\n    getDivisions: function(){\n        return exactapi.getDivisions();\n    },\n    setDivision: function(value){\n        exactapi.setDivision(parseInt(value));\n    },\n    updateOrders: function(){\n        updateOrders();\n    },\n    updateCategories: function(){\n        Categories.find({}).forEach(function(cat){\n           Orders.update({\n              category: cat.description\n           }, {\n               $set: {\n                   hoursTotal: cat.hours\n               }\n           }, {\n               multi: true\n           });\n        });\n    }\n\n});\n\nvar dateFormat = function (date) {\n    var res = date.getFullYear() + '-';\n    var month = date.getMonth()+1;\n    if(month < 10) res+= \"0\";\n    res += month + '-';\n    var day = date.getDate();\n    if(day < 10) res += \"0\";\n    res += day;\n    return res;\n};\n\nMeteor.setInterval(updateOrders, 5*60*1000);   //5 Minutes\nMeteor.setTimeout(updateOrders, 1000*10);       //After 10 seconds, try once\n\nvar MAXDIFF = 8.64e+9;//PlannedDate may be 100 days before today\n\nfunction updateOrders(){\n    console.log(\"Synchronized orders...\");\n    if(!exactapi.isAuthorized()){\n        console.log(\"Exact is not linked\");\n        return;\n    }\n\n    var orders = exactapi.getShopOrders({\n        max_status: 20,\n        min_date: new Date(Date.now()-MAXDIFF).toJSON()\n    });\n    \n    var newOrders = [];\n    orders.forEach(function(order){\n        var databaseElem = {\n            number: order.ShopOrderNumber,\n            plannedDate: exactapi.parseJSONDate(order.PlannedDate),\n            description: order.Description,\n            status: order.Status,\n            entryDate: exactapi.parseJSONDate(order.EntryDate),\n        }\n\n        var blacklist = Blacklist.findOne({ type: 'order', number: databaseElem.number});\n        if(blacklist){\n            console.log(\"Order \"+databaseElem.number+\" is on the blacklist, discarding...\");\n            return;\n        }\n\n        if(Date.now() - databaseElem.plannedDate > MAXDIFF){\n            console.log(\"Order \"+databaseElem.number+\" is more than 100 days old, discarding...\");\n            return;\n        }\n\n        var salesOrderLine = order.SalesOrderLines.results[0];\n        if(salesOrderLine){\n            databaseElem.description = salesOrderLine.Description;\n            databaseElem.customer = exactapi.getSalesOrder(salesOrderLine.OrderID).DeliverToName;\n            databaseElem.salesOrderLines = [];\n            exactapi.getSalesOrderLines(salesOrderLine.OrderID).forEach(function(line){\n                databaseElem.salesOrderLines[line.LineNumber-1] = {\n                    deliveryDate: dateFormat(exactapi.parseJSONDate(line.DeliveryDate)),\n                    description: line.Description,\n                    netPrice: line.NetPrice,\n                    discount: (parseFloat(line.Discount)*100).toFixed(2)\n                };\n            });\n        }\n        else {\n            console.log(\"No sales order line: \"+order.SalesOrderLines);\n        }\n\n        var old_elem = Orders.findOne({ number: order.ShopOrderNumber });\n        if(old_elem){\n            //console.log(\"Taking category from old entry\");\n            databaseElem.category = old_elem.category;\n            databaseElem.tasks = old_elem.tasks;\n            if(old_elem.hoursTotal) databaseElem.hoursTotal = old_elem.hoursTotal;\n        }\n        else {\n            var item = exactapi.getItem(order.Item);\n            if(item){\n                databaseElem.category = item.ItemGroupDescription;\n                var cat = Categories.findOne({ description: databaseElem.category });\n                if(cat){\n                    databaseElem.hoursTotal = cat.hours;\n                }\n                else {\n                    console.log(\"No matching category found for \"+databaseElem.category);\n                }\n            }\n            else {\n                console.log(\"No item on order \"+order.ShopOrderNumber);\n            }\n        }\n        newOrders.push(databaseElem);\n    });\n    if(newOrders.length == 0){\n        console.log(\"NO ORDERS FOUND!\");\n        return;\n    }\n    Orders.remove({});\n    Orders.batchInsert(newOrders);\n    console.log(\"Synchronized \"+newOrders.length+\" orders\");\n}\n\nMeteor.setInterval(function(){\n    console.log(\"Refreshing token\");\n    exactapi.tokenRefresh();\n}, 500*1000);   //Every 8.33 minutes a token refresh occurs","Employees = new Mongo.Collection(\"employees\");\nEvents = new Mongo.Collection(\"events\");\nOrders = new Mongo.Collection(\"orders\");\nCategories = new Mongo.Collection(\"categories\");\nBlacklist = new Mongo.Collection(\"blacklist\");\n\nif (Meteor.isClient) {\n    Meteor.subscribe(\"employees\");\n    Meteor.subscribe(\"events\");\n    Meteor.subscribe(\"orders\");\n    Meteor.subscribe(\"categories\");\n    Meteor.subscribe(\"blacklist\");\n\n\n    Template.calendar.onRendered(function(){\n        var calendar = $('#calendar');\n        calendar.fullCalendar();\n\n        function onEventsChanged(){\n            $(\".fc\").fullCalendar(\"refetchEvents\");\n        };\n\n        //Make sure any changes to the events are passed on to all clients\n        Events.find({}).observeChanges({\n            added: function(){\n                onEventsChanged();\n            },\n            changed: function(){\n                onEventsChanged();\n            },\n            removed: function(){\n                onEventsChanged();\n            }\n        });\n\n    });\n\n    function addEvent (date) {\n        var employee = Session.get(\"newEventEmployee\");\n        var order = Session.get(\"newEventOrder\");\n        var start;\n        var allday = $('.fc').fullCalendar(\"getView\").type != \"agendaDay\";\n        if(!date) {\n            date = $(\"#newEventDate\").val();\n            var moment = $.fullCalendar.moment;\n            if(allday){\n                start = moment(date);\n            }\n            else {\n                //Start at 8 AM if no time was provided\n                start = moment(date+'T08:00');\n            }\n        }\n        else {\n            start = date;\n        }\n        var hours = parseInt($(\"#newEventHours\").val()) || 0;\n        var end;\n        if(!allday){\n            end = start.clone();\n            end.hours(start.hours()+hours);\n            end = end.format();\n        }\n        var newEvent = {\n            start: start.format(),\n            end: end,\n            allday: false,\n            employee: employee,\n            hours: hours\n        };\n        var formSide = $('.special.event.form').parent().parent();\n        if(formSide.hasClass('active')){ //If the active side of the bar is the orderless one,\n            //This is a special event without an order\n            newEvent.type = $('input[name=\"itemType\"]:checked').val();\n            newEvent.description = $('input[name=\"notes\"]').val();\n        }\n        else {\n            //This is a standard event with an order\n            newEvent.order = order;\n            var fullOrder = Orders.findOne({number: parseInt(order)});\n            if(fullOrder){\n                newEvent.customer = fullOrder.customer;\n                newEvent.description = fullOrder.description;\n            }\n        }\n        Events.insert(newEvent, function (error, id) {\n            if (error) return console.error(error);\n        });\n    };\n\n    //Updates the state of the new event button, depending on selected employees, orders and the side of the order bar\n    window.setAddEventState = function(){\n        var ordersVisible = $('.side').first().hasClass('active');\n\n        var specialTypeSelected = !$('.special.event.checkbox').checkbox('is unchecked').every(function(val){return val;});\n\n        if(Session.get(\"newEventEmployee\") && (                     //An employee has been selected\n            (Session.get(\"newEventOrder\") && ordersVisible) ||      //An order is selected and we are on the orders side\n            !ordersVisible && specialTypeSelected)                  //We are on the special side and a type is selected\n        ){\n            // Enable the button\n            Session.set(\"addEventButtonState\", \"active\");\n            console.log(\"sts: \"+specialTypeSelected);\n            console.log(\"ov: \"+ordersVisible);\n        }\n        else {\n            // Disable\n            Session.set(\"addEventButtonState\", \"disabled\");\n        }\n        updateNewEventDraggable();\n    };\n\n    var onEventChange = function (event) {\n        var savedEvent = {\n            _id: event._id,\n            title: event.title,\n            start: event.start.format(),\n            allday: event.allday,\n            employee: event.employee,\n            order: event.order,\n            hours: event.hours,\n            customer: event.customer,\n            description: event.description,\n            type: event.type\n        };\n        if (event.end) {\n            //Update the number of hours\n            savedEvent.end = event.end.format();\n            savedEvent.hours = event.end.diff(event.start, 'hours');\n        }\n        Events.update({_id: savedEvent._id}, savedEvent, {multi: false, upsert: true}, function (error, affected) {\n            if (error) console.error(error);\n        });\n    };\n\n    //Request the exact authentication url from the exact-api plugin\n    Meteor.call(\"getExactURL\", function(err, res) {\n        Session.set(\"exactURL\", res);\n    });\n\n    //Set the exact link state as a Session variable, so we can use it in spacebars\n    Meteor.call(\"exactIsLinked\", function(err, res){\n        Session.set(\"exact_linked\", res);\n    });\n\n    Template.navbar.helpers({\n        exact_url: function(){\n            return Session.get(\"exactURL\");\n        },\n        exact_linked: function(){\n            return Session.get(\"exact_linked\");\n        }\n    });\n\n    //Adds an order to the blacklist\n    window.addBlacklist = function(id){\n        var number = Orders.findOne({_id: id}).number;\n        Blacklist.insert({\n            type: 'order',\n            number: number\n        });\n        Orders.remove({ _id: id});\n    }\n\n    Template.resourcesbar.helpers({\n        addEventButtonState: function(){\n            return Session.get(\"addEventButtonState\");\n        }\n    });\n\n    Template.resourcesbar.events({\n        'click .add': function(){\n            addEvent();\n        }\n    });\n\n    Template.resourcesbar.onRendered(function(){\n        $('#newEventDate').val(dateFormat(new Date()));\n        $('.shape').shape({\n            onChange: function(){\n                setAddEventState();\n            }\n        });\n        $('.special.event.radio.checkbox').checkbox({\n            onChange: function(){\n                setAddEventState()\n            }\n        });\n    });\n\n    Template.calendar.helpers({\n        options: function () {\n            return {\n                theme: false,\n                weekends: false,\n                businessHours: true,\n                defaultView: 'basicWeek',\n                header: {\n                    center: 'basicWeek, month, agendaDay'\n                },\n                editable: true,\n                events: function (start, end, tz, callback) {\n                    window.setTimeout(function () {\n                        var theEvents = Events.find({ start: { $gte: start.format() } });\n                        callback(theEvents.fetch());\n                    }, 200);\n                },\n                eventResize: function (event) {\n                    onEventChange(event);\n                },\n                eventDrop: function (event) {\n                    onEventChange(event);\n                },\n                eventRender: function(event, element){\n                    var content = element.find(\".fc-content\");\n                    var title = element.find(\".fc-title\");\n                    if(!title.length){\n                        console.log(\"No title!\");\n                        $(content).prepend(\"<span style='float: left' class='fc-title'></span>\");\n                        title = content.find('.fc-title');\n                        if(!title.length){\n                            console.log(\"Still can't find it\");\n                        }\n                    }\n                    title.html(getEventTitle(event));\n                    title.click(showEventProperties);\n                    content.append(\"<button onclick=\\\"showEventDeleteModal('\"+event._id+\"')\\\" class='ui compact transparent right floated icon button'><i class='remove icon'></i></button>\");\n                    if(event.type == \"Met verlof\"){\n                        $(element).addClass('striped');\n                    }\n                    else $(element).css(\"background-color\", getOrderColor(event.order));\n                    if(hasEmployeeOverlap(event)){\n                        $(element).css(\"border\", \"3px solid red\");\n                    }\n                },\n                dayClick: function(date){\n                    $('#newEventDate').val(dateFormat(date.toDate()));\n                },\n                eventClick: function(event){\n                    Session.set(\"currentEvent\", Events.findOne({ _id: event._id }));\n                },\n                droppable: true,\n                drop: function(date) {\n                    addEvent(date);\n                }\n\n            };\n        },\n    });\n\n    window.getEventTitle = function(event){\n        if(event.title) return event.title;\n        var title = \"\";\n        if(event.order) title += event.order + \". \";\n        if(event.employee) title += event.employee + \": \";\n        if(event.type) title += event.type + \": \";\n        if(event.description) title += event.description + \"<br />\";\n        if(event.customer) title += event.customer + \", \";\n        if(event.hours) title += event.hours + \" uur\";\n        return title;\n\n    }\n\n    window.hasEmployeeOverlap = function(event){\n        if(event.type == \"Met verlof\") return false;\n        var start = event.start;\n        var end;\n        if(event.end){\n            end = event.end;\n        }\n        else {\n            end = event.start.clone().add(1, 'days');\n        }\n        var cursor = Events.find({\n            $or: [\n                {\n                    start: {\n                        $lte : start.format()\n                    },\n                    end: {\n                        $gte: end.format()\n                    }\n                },\n                {\n                    start: start.format(),\n                    end: {\n                        $exists: false\n                    }\n                }\n\n            ],\n            employee: event.employee,\n            type: \"Met verlof\"\n        });\n        return (cursor.count() > 0);\n    }\n\n    Accounts.ui.config({\n        passwordSignupFields: \"USERNAME_ONLY\"\n    });\n}\n\nif (Meteor.isServer) {\n    Meteor.publish(\"events\", function () {\n        return Events.find();\n    });\n    Meteor.publish(\"orders\", function () {\n        return Orders.find();\n    });\n    Meteor.publish(\"employees\", function () {\n        return Employees.find();\n    });\n    Meteor.publish(\"categories\", function(){\n        return Categories.find();\n    });\n    Meteor.publish(\"blacklist\", function(){\n        return Blacklist.find();\n    });\n  Meteor.startup(function () {\n    // code to run on server at startup\n  });\n}\n","daydiff = function(first, second) {\n    return Math.round((second-first)/(1000*60*60*24));\n};\ndateFormat = function (date) {\n    var res = date.getFullYear() + '-';\n    var month = date.getMonth()+1;\n    if(month < 10) res+= \"0\";\n    res += month + '-';\n    var day = date.getDate();\n    if(day < 10) res += \"0\";\n    res += day;\n    return res;\n}\n","Meteor.startup(function () {\n    Router.route('/', {\n        template: 'main'\n    });\n\n    Router.route(\"/project/:code\", function() {\n       this.render(\"project\", {data: { code: this.params.code }});\n    });\n\n    Router.route(\"/project/\", function() {\n       this.render(\"project_search\");\n    });\n\n    Router.route(\"/shoporder/:number\", function () {\n        this.render('shoporder', {data: {number: this.params.number}});\n    });\n\n    Router.route(\"/shoporder/\", function(){\n        this.render(\"shoporder_search\");\n    })\n\n    console.log(\"Registering routes\");\n});"]}